<div class="container mt-4">
  <h1 class="text-center mb-6">Torneos</h1>
  <div class="d-flex justify-content-between align-items-end flex-wrap mb-3">
    <!-- Filtro -->
    <div class="d-flex flex-column flex-md-row align-items-start gap-2">
      <div>
        <label class="form-label mb-1">Buscar</label>
        <input type="text" class="form-control form-control-sm" style="height: 36px;" placeholder="Buscar"
          [(ngModel)]="filter" name="filter" />
      </div>
      <!-- Fecha -->
      <div>
        <label class="form-label mb-1">Fecha</label>
        <input type="date" class="form-control" formControlName="fecha" />
      </div>
      <div class="d-flex gap-2 pt-md-4">
        <button class="btn btn-secondary btn-sm d-flex align-items-center" style="height: 36px;" (click)="clear()">
          <i class="fas fa-times me-1"></i> Limpiar
        </button>
        <button class="btn btn-danger btn-sm d-flex align-items-center" style="height: 36px;" (click)="search()">
          <i class="fas fa-search me-1"></i> Buscar
        </button>
      </div>
    </div>

    <!-- Botón Crear -->
    <div class="pt-md-4">
      <button class="btn btn-success btn-sm d-flex align-items-center" style="height: 36px;"
        (click)="openModal(modalToreno)">
        <i class="fas fa-plus-circle me-1"></i> Crear
      </button>
    </div>
  </div>


  <hr />
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-rounded table-hover border table-bordered border-gray-300 table-vmiddle text-center">
        <thead class="bg-light-secondary">
          <tr class="fw-bold">
            <th>ID:</th>
            <th>Img</th>
            <th>Nombre</th>
            <th>Fecha</th>
            <th>Lugar</th>
            <th>Modalidad</th>
            <th>Categoria</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let date of hitorial_torneos">
            <td>{{ date.id }}</td>
            <td>
              <div>
                <img [src]="date.img" alt="Foto de perfil" style="width: 40px; height: 40px" class="rounded-circle" />
                <div class="ms-3"></div>
              </div>
            </td>
            <td class="align-items-center">
              <a class="link-offset-2 link-underline link-underline-opacity-0 link-secondary">{{ date.nombre }}</a>
            </td>
            <td>{{ date.fecha }}</td>
            <td>{{ date.lugar }}</td>
            <td>{{ date.modalidad }}</td>
            <td>{{ date.categoria }}</td>
            <td>
              <div class="d-flex justify-content-center gap-2">
                <!-- Botón Editar - Azul suave -->
                <button class="btn btn-sm d-flex align-items-center justify-content-center px-2" style="
                    background-color: rgba(0, 123, 255, 0.1);
                    color: #007bff;
                    border-radius: 0.5rem;
                    min-width: 40px;
                    height: 36px;
                  " (click)="openModal(modalToreno)">
                  <i class="fas fa-edit"></i>
                </button>

                <!-- Botón Eliminar - Rojo suave -->
                <button class="btn btn-sm d-flex align-items-center justify-content-center px-2" style="
                    background-color: rgba(220, 53, 69, 0.1);
                    color: #dc3545;
                    border-radius: 0.5rem;
                    min-width: 40px;
                    height: 36px;
                  " (click)="deleteUser(id_torneo!)">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!--MODAL-->
<ng-template #modalToreno>
  <div class="modal-content">

    <div class="modal-header bg-primary text-white py-2 px-3 d-flex justify-content-between align-items-center">
      <h2 class="modal-title flex-grow-1 m-0">
        {{ id_torneo ? 'Editar' : 'Crear' }} Torneos
      </h2>
      <button type="button" class="btn-close btn-close-white ms-2" aria-label="Close" (click)="closeModal()"
        style="filter: brightness(0) invert(1);"></button>
    </div>

    <div class="modal-body">

      <form #frm="ngForm" (ngSubmit)="saveTournament(frm)" novalidate>
        <div class="mb-2">
          <label class="form-label">Nombre</label>
          <input type="text" class="form-control" name="nombre" required [(ngModel)]="nuevoTorneo.nombre" />
        </div>

        <div class="mb-2">
          <label class="form-label">Fecha</label>
          <input type="date" class="form-control" name="fecha" required [(ngModel)]="nuevoTorneo.fecha" />
        </div>

        <div class="mb-2">
          <label class="form-label">Lugar</label>
          <input type="text" class="form-control" name="lugar" required [(ngModel)]="nuevoTorneo.lugar" />
        </div>

        <div class="mb-2">
          <label class="form-label">Modalidad</label>
          <select class="form-select" name="modalidad" required [(ngModel)]="nuevoTorneo.modalidad">
            <option value="" disabled selected>Seleccionar</option>
            <option>Individual</option>
            <option>Equipos</option>
            <option>Mixto</option>
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label">Categoría</label>
          <select class="form-select" name="categoria" required [(ngModel)]="nuevoTorneo.categoria">
            <option value="" disabled selected>Seleccionar</option>
            <option>Sub-18</option>
            <option>Sub-21</option>
            <option>Mayores</option>
            <option>Libre</option>
            <option>Todas las categorías</option>
          </select>
        </div>

        <div class="d-flex justify-content-end gap-2">
          <button type="button" class="btn btn-outline-secondary" (click)="closeModal()">Cancelar</button>
          <button type="submit" class="btn btn-success" [disabled]="frm.invalid">
            Guardar
          </button>
        </div>
      </form>
    </div>
  </div>
</ng-template>
