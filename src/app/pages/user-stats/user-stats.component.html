<div class="container py-4">
  <!-- üîπ Tarjetas resumen -->
  <div class="row g-4 mb-4">
    <!-- Total Torneos -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm h-100 rounded-4 text-center">
        <div class="card-body">
          <img [src]="imagenesEstadisticas['torneo']" width="50" class="mb-2" />
          <h4>Total Torneos</h4>
          <h2 class="fw-bold text-primary">{{ dashboardStats?.totalTournaments ?? 0 }}</h2>
        </div>
      </div>
    </div>

    <!-- Total L√≠neas -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm h-100 rounded-4 text-center">
        <div class="card-body">
          <img [src]="imagenesEstadisticas['chuzas']" width="50" class="mb-2" />
          <h4>L√≠neas Jugadas</h4>
          <h2 class="fw-bold text-primary">{{ dashboardStats?.totalLines ?? 0 }}</h2>
        </div>
      </div>
    </div>

    <!-- Promedio General -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm h-100 rounded-4 text-center">
        <div class="card-body">
          <img [src]="imagenesEstadisticas['promedio']" width="50" class="mb-2" />
          <h4>Promedio General</h4>
          <h2 class="fw-bold text-success">{{ dashboardStats?.avgScoreGeneral | number: '1.2-2' }}</h2>
        </div>
      </div>
    </div>

    <!-- Mejor L√≠nea -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm h-100 rounded-4 text-center">
        <div class="card-body">
          <img [src]="imagenesEstadisticas['mejorJuego']" width="50" class="mb-2" />
          <h4>Mejor L√≠nea</h4>
          <h2 class="fw-bold text-danger">{{ dashboardStats?.bestLine ?? 0 }}</h2>
        </div>
      </div>
    </div>
  </div>

  <hr>

  <!-- Promedio por Torneo -->
  <div class="row g-4 mb-4">
    <div class="col-12">
      <h4 class="mb-2 d-flex align-items-center gap-2">
        <i class="fa-solid fa-chart-line text-primary"></i> Promedio por Torneo
      </h4>
      <div class="card border-0 shadow-sm rounded-4">
        <div class="card-body" style="position: relative; height: 280px;">
          <canvas #lineChartCanvas></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Gr√°ficas -->
  <div class="row g-4 mb-5">
    <!-- Promedio por modalidad -->
    <div class="col-md-6">
      <h4 class="mb-2 d-flex align-items-center gap-2">
        <i class="fa-solid fa-bowling-ball text-success"></i> Promedio por Modalidad
      </h4>
      <div class="card border-0 shadow-sm rounded-4">
        <div class="card-body">
          <canvas #barChartModalidad height="220"></canvas>
        </div>
      </div>
    </div>

    <!-- Distribuci√≥n de puntajes -->
    <div class="col-md-6">
      <h4 class="mb-2 d-flex align-items-center gap-2">
        <i class="fa-solid fa-chart-column text-warning"></i> Distribuci√≥n de Puntajes
      </h4>
      <div class="card border-0 shadow-sm rounded-4">
        <div class="card-body">
          <canvas #pieChartDistribucion height="220"></canvas>
        </div>
      </div>
    </div>
  </div>

  <hr>

  <!-- üîπ Mejores Torneos -->
  <div class="row g-4 mb-4">
    <div class="col-12">
      <h4 class="mb-3">üèÜ Mejores Torneos</h4>
      <div class="table-responsive">
        <table class="table table-hover table-sm text-center align-middle">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Imagen</th>
              <th>Nombre</th>
              <th>Promedio</th>
              <th>Fecha Inicio</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let torneo of dashboardStats?.avgPerTournament; let i = index">
              <td>{{ i + 1 }}</td>
              <td>
                <img [src]="apiUrl + torneo.imageUrl" (error)="onImgError($event, 'assets/img/torneoDefault.png')"
                  alt="img" width="40" height="40" class="rounded-circle" />
              </td>
              <td>{{ torneo.tournamentName }}</td>
              <td>{{ torneo.average | number: '1.2-2' }}</td>
              <td>{{ torneo.startDate | date: 'mediumDate' }}</td>

              <td class="text-center"><button class="btn btn-sm px-2"
                  [routerLink]="['/tournament-summary', torneo.tournamentId]"
                  style="background-color: rgba(0, 123, 255, 0.1); color: #007bff; border-radius: 0.5rem; min-width: 40px; height: 36px;">
                  <i class="fa-solid fa-eye"></i> </button></td>
            </tr>
            <tr *ngIf="!dashboardStats?.avgPerTournament?.length">
              <td colspan="6">
                <div class="alert alert-warning">No hay torneos para mostrar.</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
